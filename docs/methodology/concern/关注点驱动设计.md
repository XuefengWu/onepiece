### 关注点驱动设计所要解决的问题
首先我需要说明一下我对架构设计的理解，有人对架构设计活动的定义是一系列妥协，我认为这个定义是片面的。
系统架构设计主要任务是根据各方诉求，定义系统目标和边界，创造各方价值最大化的解决方案，并且管理好系统复杂度。
由于现有的技术条件、资源、能力、或者创新的约束，我们可能做不到令各方都满意的方案，这个时候才需要进行妥协或平衡。
重要的事情再说一遍，系统架构设计最主要的目的是创造各方多赢的解决方案，而不是各方相互妥协的解决方案。

系统架构师创造出的解决方案中的大部分内容会令各方都满意，那么就会没有太多争议，也没多少人会关注。
解决方案中的部分可能会使某些干系人利益受损，这时就会引起很大的争议，引起多方关注和讨论，这个时候就需要做妥协和平衡。
因此可以说系统架构设计的能力或艺术之一是妥协和平衡。

关注点驱动设计的主要解决的问题就是如何做出系统架构设计的妥协和平衡决策。

关注点驱动设计的另一个目的是指导架构设计的视角。现有的4+1架构视图有效得指导了宏观企业架构设计，但不能指导系统日常开发的架构设计。关注点驱动即使针对相同的代码，因为不同需求或问题所关心的点不同，所画出来的架构设计图视角也不同。

### 什么是关注点
关注点的笼统的定义是人们关心的东西，这些人包括客户、用户、企业管理、监管部门、开发人员、实施运维人员等。
这里有个假设，系统是与人打交道并为人服务，这里说的系统不是一个静止不动的东西，而是一直持续变化的事物，它有非常丰富的多方面表现。

### 我们已经有很多XX驱动设计了，为什么还提出关注点驱动设计
现在主要流行的架构设计方法有风险驱动设计，领域驱动设计，整洁架构，敏捷的简单设计等，这些架构设计方法都提出了很有实操性的工作方法，但实际中几乎没有遇到过纯粹使用某个方法或框架的情况。那是什么原因呢，是这些方法错了吗，还是我们能力不足才用不起来。我一开始确实有认为是开发团队能力问题才导致用不起来这些设计方法，但现在发现这个认识也是片面的。首先这些设计方法本身就相互不一样，各说各话。其次开发资源和人员能力很大部分是系统架构设计的背景，是系统架构设计要解决的问题，而不是抱怨的理由。

我发现现行的设计方法为了说明方便或者为了更具实操性都有假设情况或领域，这些假设也成了设计方法普适性的局限。我进一步研究现行的设计方法以及结合自身的架构设计经验，发现可以把设计方法的核心要素再做一次提炼，这个提炼出的概念就叫关注点，它可以解释现有所有的架构设计方法的合理性以及其局限性，也可以用以指导现有架构设计过程中的很多争论点。

## 如何解决架构设计中的两个都行的决策问题
### 争论例子1： DDD中的聚合怎么划分
为了划分大型复杂系统的对象关系，DDD提出了聚合的概念，定义聚合内的对象业务规则具有不变性，或者业务对象的生命周期的一致性。
实际中会发现一个大的对象关系中，几乎所有对象都需要满足业务规则不变性，比如客户下个订单，那么库存、优惠券、收款这些对象的业务规则都需要是完整不变的，那么怎么划分聚合呢？其实DDD创造人Eric已经提出了解决方案，但是没有明确把原理说出来，导致我们不知道怎么用。Eric提出聚合的唯一入口是聚合根，也就是聚合中的一个实体。这里我想引入函数式编程的一个概念---一等公民。一等公民指可以独立在存在，不需要依赖其他东西。比如函数在面向对象编程语言里面不能独立定义，必须要定义在对象里面，那么函数在面向对象编程语言中就不是一等公民。那么在函数式编程语言中，函数可以不依赖对象进行定义，可以脱离对象独立存活，这时叫函数为一等公民。
同样可以理解成Eric提出的聚合根是聚合里面的一等公民对象，其他对象都依存在这个一等公民对象。到现在为止我只引入了一等公民的概念，并没有解决如何划分聚合的问题。
因此从开发的角度看，其实对象是一等公民还是其他说明的，好像都需要同样的设计和开发工作，没有太大的区别。
这时我们已经站在开发的关注点进行了各自考量但没有结论，这时需要引入新的、可能更重要的关注点来看待这个问题。
把聚合根定义为一等公民的原因是我们要重视它，那么谁重视它呢？ 其实不是开发，开发重视的是维护业务规则不变性所需要的成本。
所以在切分聚合的时候站在开发角度得不出哪个更好的结论，聚合根作为一等公民是为了满足业务领域的关注。
还是以客户下订单为例，这里涉及到订单、库存、优惠券、收款等业务对象，那么这些业务对象谁关注呢？ 显然是业务专家。
如果一些业务对象在业务领域中不重要，那么可以就不用作为聚合根，如何非常重要就需要设为聚合根。
这时我们发现如何划分聚合其实没有一个标准答案，但不是说怎么划分都对，或者说没有最好的划分方式。
只是聚合的划分要根据企业的业务关注点来决定，相同的业务对象在不同的企业业务关注度不一样，也会带来不同的聚合划分方式。

### 争论例子2： 先分层还是先分块
整洁架构、六边形架构、洋葱架构、DDD应用分层架构都提出来系统架构分层参考，分层的目的是管理系统复杂性。
那么DDD的领域划分、界限上下文谁，或者最基本的大型系统设计都要求做模块设计，我简单称为分块设计，目的也是管理系统复杂性。
当一个系统复杂到既需要分层又需要分块的时候，我们是要先分层，还是先分块？
一般来说我们都会对一个大系统进行模块设计，也就是先分块。但一个模块可能足够大，需要再进行分块的时候就会引起先分层还是先分块的争论。
当然我看到大部分情况不是先分层还是先分块的争论，而是不合理的架构设计提高了开发难度，增加了开发成本。
在一个模块内讨论先分层还是先分块的是讨论哪个应该是一等公民，层是一等公民，还是块是一等公民。
这个时候我们再去把争议背后的关注点提炼出来，就会比较容易做决定了。我们就是要把最关注的东西设为一等公民。
分层的关注点是技术分工，分块的关注点是响应业务，这时就比较好做衡量了。如果更关注技术实现难度和成本，那么就先分层，把分层作为一等公民，让模块依附在各个层下。
如果响应业务是关注重点，那么就先分块，再把层次依附在各个模块下。
我们通过关注点驱动设计思想，显性提炼出了各个设计决策背后的原动力，让我们的设计决策有更充分的考虑，更容易做出各方价值最大化的设计方案。

实际情况可能是一个系统中不同模块内的关注点还不一样，所得出的结论也不一样，而不是一刀切的决定先分层还是先分块。
比如一些业务流程类模块，主要响应客户需求提供页面展示，收集数据，存数据库，这些工作都没有特别的技术含量，但需要根据业务需求做多变的响应，那么我们最好是先分块再分层。 如果有些业务规则特别复杂，或者我们有一些技术实现难度很高，那么我们会先分层，把关键的技术实现层独立出来，更有利于关注聚焦和复用。


## 指导画哪些架构图